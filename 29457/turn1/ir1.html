
<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.3/css/bootstrap.min.css"
        integrity="sha512-jnSuA4Ss2PkkikSOLtYs8BlYIeeIK1h99ty4YfvRPAlzr377vr3CXDb7sb7eEEBYjDtcYj+AjBH3FLv5uSJuXg=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />

    <style type="text/css">
        @import url("https://fonts.googleapis.com/css?family=Audiowide&display=swap");

        :root {
            --dk-gray-100: #F3F4F6;
            --dk-gray-200: #E5E7EB;
            --dk-gray-300: #D1D5DB;
            --dk-gray-400: #9CA3AF;
            --dk-gray-500: #6B7280;
            --dk-gray-600: #4B5563;
            --dk-gray-700: #374151;
            --dk-gray-800: #1F2937;
            --dk-gray-900: #111827;
            --dk-dark-bg: #313348;
            --dk-darker-bg: #2a2b3d;
            --navbar-bg-color: #6f6486;
            --sidebar-bg-color: #252636;
            --sidebar-width: 250px;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Audiowide', cursive, sans-serif;
            background-color: var(--dk-darker-bg);
            font-size: .925rem;
        }

        #wrapper {

            transition: all .3s ease-in-out;
        }

        #wrapper.fullwidth {
            margin-left: 0;
        }

        .welcome {
            color: var(--dk-gray-300);
        }

        .welcome .content {
            background-color: var(--dk-dark-bg);
        }

        .welcome p {
            color: var(--dk-gray-400);
        }

        .statistics {
            color: var(--dk-gray-200);
        }

        .statistics .box {
            background-color: var(--dk-dark-bg);
        }

        .statistics .box i {
            width: 60px;
            height: 60px;
            line-height: 60px;
        }

        .statistics .box p {
            color: var(--dk-gray-400);
        }

        .charts .chart-container {
            background-color: var(--dk-dark-bg);
        }

        .charts .chart-container h3 {
            color: var(--dk-gray-400)
        }


        .admins .box .admin {
            background-color: var(--dk-dark-bg);
        }

        .admins .box h3 {
            color: var(--dk-gray-300);
        }

        .admins .box p {
            color: var(--dk-gray-400)
        }



        .statis {
            color: var(--dk-gray-100);
        }

        .statis .box {
            position: relative;
            overflow: hidden;
            border-radius: 3px;
        }

        .statis .box h3:after {
            content: "";
            height: 2px;
            width: 70%;
            margin: auto;
            background-color: rgba(255, 255, 255, 0.12);
            display: block;
            margin-top: 10px;
        }

        .statis .box i {
            position: absolute;
            height: 70px;
            width: 70px;
            font-size: 22px;
            padding: 15px;
            top: -25px;
            left: -25px;
            background-color: rgba(255, 255, 255, 0.15);
            line-height: 60px;
            text-align: right;
            border-radius: 50%;
        }

        .main-color {
            color: #ffc107
        }

        .navbar {
            background-color: var(--navbar-bg-color) !important;
            border: none !important;
        }

        .navbar .dropdown-menu {
            right: auto !important;
            left: 0 !important;
        }

        .navbar .navbar-nav>li>a {
            color: #EEE !important;
            line-height: 55px !important;
            padding: 0 10px !important;
        }

        .navbar .navbar-brand {
            color: #FFF !important
        }

        .navbar .navbar-nav>li>a:focus,
        .navbar .navbar-nav>li>a:hover {
            color: #EEE !important
        }

        .navbar .navbar-nav>.open>a,
        .navbar .navbar-nav>.open>a:focus,
        .navbar .navbar-nav>.open>a:hover {
            background-color: transparent !important;
            color: #FFF !important
        }

        .navbar .navbar-brand {
            line-height: 55px !important;
            padding: 0 !important
        }

        .navbar .navbar-brand:focus,
        .navbar .navbar-brand:hover {
            color: #FFF !important
        }

        .navbar>.container .navbar-brand,
        .navbar>.container-fluid .navbar-brand {
            margin: 0 !important
        }

        @media (max-width: 767px) {
            .navbar>.container-fluid .navbar-brand {
                margin-left: 15px !important;
            }

            .navbar .navbar-nav>li>a {
                padding-left: 0 !important;
            }

            .navbar-nav {
                margin: 0 !important;
            }

            .navbar .navbar-collapse,
            .navbar .navbar-form {
                border: none !important;
            }
        }

        .navbar .navbar-nav>li>a {
            float: left !important;
        }

        .navbar .navbar-nav>li>a>span:not(.caret) {
            background-color: #e74c3c !important;
            border-radius: 50% !important;
            height: 25px !important;
            width: 25px !important;
            padding: 2px !important;
            font-size: 11px !important;
            position: relative !important;
            top: -10px !important;
            right: 5px !important
        }

        .dropdown-menu>li>a {
            padding-top: 5px !important;
            padding-right: 5px !important;
        }

        .navbar .navbar-nav>li>a>i {
            font-size: 18px !important;
        }


        /* Start media query */

        @media (max-width: 767px) {
            #wrapper {
                margin: 0 !important
            }

            .statistics .box {
                margin-bottom: 25px !important;
            }

            .navbar .navbar-nav .open .dropdown-menu>li>a {
                color: #CCC !important
            }

            .navbar .navbar-nav .open .dropdown-menu>li>a:hover {
                color: #FFF !important
            }

            .navbar .navbar-toggle {
                border: none !important;
                color: #EEE !important;
                font-size: 18px !important;
            }

            .navbar .navbar-toggle:focus,
            .navbar .navbar-toggle:hover {
                background-color: transparent !important
            }
        }


        ::-webkit-scrollbar {
            background: transparent;
            width: 5px;
            height: 5px;
        }

        ::-webkit-scrollbar-thumb {
            background-color: #3c3f58;
        }

        ::-webkit-scrollbar-thumb:hover {
            background-color: rgba(0, 0, 0, 0.3);
        }

        #dnfDrivers {
            display: flex;
            flex-direction: column;
            color: white;

        }
    </style>

</head>

<body>


    <section id="wrapper">
        <div class="p-4">
            <div class="welcome">
                <div class="content rounded-3 p-3">
                    <h1 class="fs-3">F1 2023 Bahrain GP Dashboard</h1>
                </div>
            </div>
    
            <!-- Driver standings will be populated here dynamically -->
            <section class="statistics mt-4">
                <div id="driver-standings" class="row"></div>
            </section>
    
            <!-- Constructor standings will be populated here dynamically -->
            <section class="statis mt-4 text-center">
                <h3>Constructors Standings</h3>
                <div id="constructor-standings" class="row"></div>
            </section>
        </div>
    </section>
    
    <div id="dnfDrivers">
        <h3>Drivers that DNF-ed or had problems:</h3>
        <ul>
            <li>Charles Leclerc - Engine problem</li>
            <li>Esteban Ocon - Mechanical problem</li>
            <li>Nyck de Vries - DNF</li>
            <li>Oscar Piastri - Electrical problem</li>
            <li>Mick Schumacher - DNF</li>
            <li>Lando Norris - DNF</li>
        </ul>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.3/js/bootstrap.bundle.min.js"
        integrity="sha512-7Pi/otdlbbCR+LnW+F7PwFcSDJOuUJB3OxtEHbg4vSMvzvJjde4Po1v4BR9Gdc9aXNUNFVUY+SK51wWT8WF0Gg=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script>
        function $(selector) {
            return document.querySelector(selector)
        }

        function find(el, selector) {
            let finded
            return (finded = el.querySelector(selector)) ? finded : null
        }

        function siblings(el) {
            const siblings = []
            for (let sibling of el.parentNode.children) {
                if (sibling !== el) {
                    siblings.push(sibling)
                }
            }
            return siblings
        }

        const wrapper = $('#wrapper')

        // Update to correctly configure global defaults in Chart.js v3+
        Chart.defaults.animation.duration = 2000; // Animation duration
        Chart.defaults.plugins.legend.display = false; // Hide legend
        Chart.defaults.color = '#71748c'; // Set default font color
        Chart.defaults.font.size = 13; // Set default font size
      
        async function fetchBahrainResults() {
        try {
            const response = await fetch('https://ergast.com/api/f1/2023/1/results.json'); // Round 1 of 2023 (Bahrain GP)
            const data = await response.json();
            const raceResults = data.MRData.RaceTable.Races[0].Results;

            // Clear existing driver and constructor standings
            document.getElementById('driver-standings').innerHTML = '';
            document.getElementById('constructor-standings').innerHTML = '';

            // Add Driver Standings dynamically
            raceResults.forEach((driverResult, index) => {
                const driverCard = `
                    <div class="col-lg-4">
                        <div class="box d-flex rounded-2 align-items-center mb-4 mb-lg-0 p-3">
                            <i class="uil-envelope-shield fs-2 text-center bg-primary rounded-circle">${driverResult.position}</i>
                            <div class="ms-3">
                                <div class="d-flex align-items-center">
                                    <h3 class="mb-0">${index + 1} ${driverResult.Driver.givenName} ${driverResult.Driver.familyName}</h3>
                                    <span class="d-block ms-2">${driverResult.Constructor.name}</span>
                                </div>
                                <p class="fs-normal mb-0">${driverResult.Driver.nationality}</p>
                            </div>
                        </div>
                    </div>
                `;
                document.getElementById('driver-standings').insertAdjacentHTML('beforeend', driverCard);
            });

            // Create a mapping for constructor standings
            const constructorStandings = {};

            raceResults.forEach((result) => {
                const constructor = result.Constructor.name;
                if (!constructorStandings[constructor]) {
                    constructorStandings[constructor] = 0;
                }
                constructorStandings[constructor] += parseInt(result.points);
            });

            // Sort constructors by points
            const sortedConstructors = Object.entries(constructorStandings).sort((a, b) => b[1] - a[1]);

            // Add Constructor Standings dynamically
            sortedConstructors.forEach(([constructorName, points], index) => {
                const constructorCard = `
                    <div class="col-md-6 col-lg-3 mb-4 mb-lg-0">
                        <div class="box bg-primary p-3">
                            <i class="uil-eye"></i>
                            <h3>${points}</h3>
                            <p class="lead">${constructorName}</p>
                        </div>
                    </div>
                `;
                document.getElementById('constructor-standings').insertAdjacentHTML('beforeend', constructorCard);
            });
            const fastestLapTimes = raceResults.map(driver => ({
                name: `${driver.Driver.givenName} ${driver.Driver.familyName}`,
                fastestLap: driver.FastestLap?.Time.time || "N/A",
                position: driver.position,
                constructor: driver.Constructor.name
            }));

            // Log the fastest lap times (for testing)
            console.log(fastestLapTimes);

            // Update your DOM elements with the data:
            document.querySelector('.welcome h1').textContent = `${data.MRData.RaceTable.Races[0].raceName} Dashboard`;

            // Example of dynamically updating the fastest lap chart
            const labels = fastestLapTimes.map(driver => driver.name);
            const lapTimes = fastestLapTimes.map(driver => driver.fastestLap !== "N/A" ? parseFloat(driver.fastestLap.replace(':', '.')) : 0); // converting lap times to a float if available

            // Update the bar chart with the fastest lap times
            const ctx1 = document.getElementById('myChart').getContext('2d');
            const fastestLapChart = new Chart(ctx1, {
                type: 'bar',
                data: {
                    labels: labels, // Driver names
                    datasets: [{
                        label: 'Fastest Lap Time (seconds)',
                        data: lapTimes,
                        backgroundColor: 'rgba(75, 192, 192, 0.2)',
                        borderColor: 'rgba(75, 192, 192, 1)',
                        borderWidth: 1
                    }]
                },
                options: {
                    scales: {
                        y: {
                            beginAtZero: false,
                            title: {
                                display: true,
                                text: 'Lap Time (seconds)'
                            }
                        },
                        x: {
                            title: {
                                display: true,
                                text: 'Drivers'
                            }
                        }
                    }
                }
            });

            // Similarly, update other charts and sections with raceResults data
            // Example: Time Gap chart, DNF list, etc.

        } catch (error) {
            console.error('Error fetching Bahrain GP results:', error);
        }
    }

    // Call the function when the page loads
    window.onload = fetchBahrainResults;
    </script>
</body>

</html>