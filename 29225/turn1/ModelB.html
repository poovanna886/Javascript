<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Leitner Flashcard System</title>
<link rel="stylesheet" href="style.css">
</head>
<body>
<div id="game-container">
  <div id="flashcard">
    <div id="card-front">Question will appear here</div>
    <div id="card-back">Answer will appear here</div>
  </div>
  <button onclick="flipCard()">Flip Card</button>
  <button onclick="markCorrect()">Mark as Correct</button>
  <button onclick="markIncorrect()">Mark as Incorrect</button>
  <div id="progress">Cards left: <span id="cards-left">15</span></div>
  <button onclick="resetProgress()">Reset Progress</button>
</div>
<div id="scoreGraph" style="width:80%; height:200px;"></div>

<script src="https://cdn.jsdelivr.net/npm/p5@1.4.0/lib/p5.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js@3.7.0/dist/chart.min.js"></script>
<script>
let currentCard;
let cards = {
  easy: [...Array(5)].map((_, i) => ({q: `Easy Q${i+1}`, a: `Easy A${i+1}`, box: 1})),
  medium: [...Array(5)].map((_, i) => ({q: `Medium Q${i+1}`, a: `Medium A${i+1}`, box: 2})),
  hard: [...Array(5)].map((_, i) => ({q: `Hard Q${i+1}`, a: `Hard A${i+1}`, box: 3}))
};
let currentDeck = [];
let flipped = false;

function setup() {
  if (!localStorage.getItem('flashcards')) {
    localStorage.setItem('flashcards', JSON.stringify(cards));
  } else {
    cards = JSON.parse(localStorage.getItem('flashcards'));
  }
  selectCard();
}

function selectCard() {
  // Simplified frequency logic for demonstration
  let boxWeights = [1, 3, 5]; // easy, medium, hard
  let totalWeight = boxWeights.reduce((a, b) => a + b, 0);
  let randomWeight = Math.random() * totalWeight;
  let cumulativeWeight = 0;
  
  for(let i = 0; i < boxWeights.length; i++) {
    cumulativeWeight += boxWeights[i];
    if(randomWeight < cumulativeWeight && cards[['easy', 'medium', 'hard'][i]].length > 0) {
      currentDeck = cards[['easy', 'medium', 'hard'][i]];
      currentCard = currentDeck[Math.floor(Math.random() * currentDeck.length)];
      break;
    }
  }
  document.getElementById('card-front').innerText = currentCard.q;
  document.getElementById('cards-left').innerText = currentDeck.length;
  flipped = false;
}

function flipCard() {
  flipped = !flipped;
  document.getElementById('card-front').style.display = flipped ? 'none' : 'block';
  document.getElementById('card-back').style.display = flipped ? 'block' : 'none';
  if(flipped) document.getElementById('card-back').innerText = currentCard.a;
}

function markCorrect() {
  // Move to next box or keep in hard if already there
  if(currentCard.box < 3) currentCard.box++;
  selectCard();
}

function markIncorrect() {
  currentCard.box = 1; // Move to easy
  selectCard();
}

function resetProgress() {
  localStorage.removeItem('flashcards');
  setup();
}

// p5.js for animations
function draw() {
  // Here you would implement animations with p5.js
}

// Setup for score graph
let ctx = document.getElementById('scoreGraph').getContext('2d');
let myChart = new Chart(ctx, {
  type: 'line',
  data: {
    labels: [],
    datasets: [{
      label: 'Score',
      data: [],
      fill: false,
      borderColor: 'rgb(75, 192, 192)',
      tension: 0.1
    }]
  },
  options: {
    scales: {
      y: {
        beginAtZero: true
      }
    }
  }
});

// Call setup when page loads
window.onload = setup;
</script>
</body>
</html>