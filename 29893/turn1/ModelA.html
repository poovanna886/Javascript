<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Santa's Present Drop</title>
<style>
body {
    margin: 0;
    overflow: hidden;
    background: #000;
    color: #fff;
    font-family: 'Arial', sans-serif;
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
    background: linear-gradient(to bottom, #00bfff, #87ceeb);
}
canvas {
    border: 2px solid #fff;
    background: url('data:image/png;base64,...'); /* Placeholder for a starry night background */
}
#startScreen, #gameOverScreen {
    position: absolute;
    width: 800px;
    height: 600px;
    background: rgba(0, 0, 0, 0.7);
    display: flex;
    justify-content: center;
    align-items: center;
    flex-direction: column;
    font-size: 2em;
    color: #ff0000;
    text-shadow: 2px 2px #ffffff;
    cursor: pointer;
}
#score, #highScore {
    position: absolute;
    top: 10px;
    right: 10px;
    color: white;
    text-shadow: 2px 2px #000;
}
#highScore {
    top: 40px;
}
.message {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    font-size: 1.5em;
    color: green;
    text-shadow: 1px 1px #000;
    animation: fadeOut 2s forwards;
}
@keyframes fadeOut {
    to { opacity: 0; }
}
</style>
</head>
<body>
<div id="startScreen">Tap to Play</div>
<div id="gameOverScreen" style="display: none;">Game Over<br>Score: <span id="finalScore"></span></div>
<canvas id="gameCanvas" width="800" height="600"></canvas>
<div id="score">Score: 0</div>
<div id="highScore">High Score: 0</div>
<script>
const canvas = document.getElementById('gameCanvas');
const ctx = canvas.getContext('2d');
const startScreen = document.getElementById('startScreen');
const gameOverScreen = document.getElementById('gameOverScreen');
const scoreDisplay = document.getElementById('score');
const highScoreDisplay = document.getElementById('highScore');
const finalScoreDisplay = document.getElementById('finalScore');

let score = 0;
let highScore = localStorage.getItem('santaHighScore') || 0;
highScoreDisplay.textContent = `High Score: ${highScore}`;

let gameActive = false;
let santa, presents, chimneys;

class Santa {
    constructor() {
        this.x = 0;
        this.y = 100;
        this.width = 100;
        this.height = 50;
        this.speed = 2;
        this.image = new Image();
        this.image.src = 'https://i.imgur.com/1JtH4nL.png'; // Assume this image exists
    }

    move() {
        this.x += this.speed;
        if (this.x > canvas.width) this.x = -this.width;
    }

    draw() {
        ctx.drawImage(this.image, this.x, this.y, this.width, this.height);
    }
}

class Present {
    constructor(x, y) {
        this.x = x;
        this.y = y;
        this.width = 20;
        this.height = 30;
        this.speed = 3;
    }

    fall() {
        this.y += this.speed;
    }

    draw() {
        ctx.fillStyle = 'red';
        ctx.fillRect(this.x, this.y, this.width, this.height);
    }
}

class Chimney {
    constructor() {
        this.x = canvas.width;
        this.width = 80;
        this.height = Math.random() * 200 + 50;
        this.top = canvas.height - this.height;
    }

    move() {
        this.x -= 2;
    }

    draw() {
        ctx.fillStyle = 'brown';
        ctx.fillRect(this.x, this.top, this.width, this.height);
    }
}

function createChimney() {
    if (Math.random() < 0.02) { // Adjust frequency of chimney spawn
        chimneys.push(new Chimney());
    }
}

function showMessage(message, color = 'green') {
    const msgElement = document.createElement('div');
    msgElement.textContent = message;
    msgElement.className = 'message';
    msgElement.style.color = color;
    document.body.appendChild(msgElement);
    setTimeout(() => msgElement.remove(), 2000);
}

function updateGame() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    santa.move();
    santa.draw();

    // Update and draw chimneys
    chimneys.forEach((chimney, index) => {
        chimney.move();
        chimney.draw();
        if (chimney.x + chimney.width < 0) chimneys.splice(index, 1);
    });

    // Update and draw presents
    presents.forEach((present, index) => {
        present.fall();
        present.draw();
        if (present.y > canvas.height) {
            presents.splice(index, 1);
            showMessage('Missed!', 'red');
        } else {
            chimneys.forEach((chimney, cIndex) => {
                if (present.x < chimney.x + chimney.width && 
                    present.x + present.width > chimney.x && 
                    present.y + present.height > chimney.top) {
                    presents.splice(index, 1);
                    chimneys.splice(cIndex, 1);
                    score++;
                    scoreDisplay.textContent = `Score: ${score}`;
                    showMessage('Nice Drop!');
                    if (score > highScore) {
                        highScore = score;
                        localStorage.setItem('santaHighScore', highScore);
                        highScoreDisplay.textContent = `High Score: ${highScore}`;
                    }
                }
            });
        }
    });

    createChimney();
    
    if (gameActive) requestAnimationFrame(updateGame);
    else gameOver();
}

function startGame() {
    gameActive = true;
    santa = new Santa();
    presents = [];
    chimneys = [];
    score = 0;
    scoreDisplay.textContent = `Score: ${score}`;
    startScreen.style.display = 'none';
    updateGame();
}

function gameOver() {
    gameActive = false;
    gameOverScreen.style.display = 'flex';
    finalScoreDisplay.textContent = score;
}

canvas.addEventListener('click', function(e) {
    if (!gameActive) {
        startGame();
    } else {
        presents.push(new Present(santa.x + santa.width / 2, santa.y + santa.height));
    }
});

gameOverScreen.addEventListener('click', startGame);

document.getElementById('startScreen').addEventListener('click', startGame);
</script>
</body>
</html>